services:
    Claroline\CoreBundle\Listener\DataSource\Workspace\AllSource:
        arguments:
            - '@security.authorization_checker'
            - '@security.token_storage'
            - '@Claroline\AppBundle\API\FinderProvider'
        tags:
            - { name: kernel.event_listener, event: data_source.workspaces.load, method: getData }

    Claroline\CoreBundle\Listener\DataSource\Workspace\RegisteredSource:
        arguments:
            - '@security.token_storage'
            - '@Claroline\AppBundle\API\FinderProvider'
        tags:
            - { name: kernel.event_listener, event: data_source.my_workspaces.load, method: getData }

    Claroline\CoreBundle\Listener\DataSource\AdminToolSource:
        arguments:
            - '@Claroline\AppBundle\API\FinderProvider'
            - '@security.token_storage'
        tags:
            - { name: kernel.event_listener, event: data_source.admin_tools.load, method: getData }

    Claroline\CoreBundle\Listener\DataSource\ResourceSource:
        arguments:
            - '@Claroline\AppBundle\Persistence\ObjectManager'
            - '@Claroline\AppBundle\API\FinderProvider'
            - '@security.token_storage'
        tags:
            - { name: kernel.event_listener, event: data_source.resources.load, method: getData }

    Claroline\CoreBundle\Listener\DataSource\ToolSource:
        arguments:
            - '@Claroline\AppBundle\API\FinderProvider'
            - '@Claroline\AppBundle\API\SerializerProvider'
            - '@security.token_storage'
            - '@Claroline\CoreBundle\Manager\Workspace\WorkspaceManager'
        tags:
            - { name: kernel.event_listener, event: data_source.tools.load, method: getData }

    Claroline\CoreBundle\Listener\Resource\Types\DirectoryListener:
        tags: ['claroline.component.resource', 'kernel.event_subscriber']
        arguments:
            - '@Claroline\AppBundle\Persistence\ObjectManager'
            - '@Claroline\AppBundle\API\SerializerProvider'
            - '@Claroline\AppBundle\API\Crud'
            - '@Claroline\CoreBundle\Manager\FileManager'
            - '@Claroline\CoreBundle\Manager\ResourceManager'
            - '@Claroline\CoreBundle\Manager\Resource\ResourceActionManager'
            - '@Claroline\CoreBundle\Manager\Resource\RightsManager'

    Claroline\CoreBundle\Listener\Resource\Types\FileListener:
        tags: ['claroline.component.resource', 'kernel.event_subscriber']
        arguments:
            - '@event_dispatcher'
            - '@Claroline\AppBundle\Persistence\ObjectManager'
            - '@Claroline\AppBundle\API\SerializerProvider'
            - '@Claroline\CoreBundle\Manager\FileManager'

    Claroline\CoreBundle\Listener\Resource\Types\TextListener:
        tags: ['claroline.component.resource', 'kernel.event_subscriber']
        arguments:
            - '@Claroline\AppBundle\API\SerializerProvider'
            - '@Claroline\AppBundle\Manager\PdfManager'
            - '@Claroline\CoreBundle\Manager\Template\PlaceholderManager'

    Claroline\CoreBundle\Listener\Resource\ResourceListener:
        arguments:
            - '@security.token_storage'
            - '@security.authorization_checker'
            - '@event_dispatcher'
            - '@twig'
            - '@Claroline\AppBundle\Persistence\ObjectManager'
            - '@Claroline\AppBundle\API\Crud'
            - '@Claroline\AppBundle\API\SerializerProvider'
            - '@Claroline\CoreBundle\Manager\ResourceManager'
            - '@Claroline\CoreBundle\Manager\Resource\ResourceLifecycleManager'
        tags:
            - { name: kernel.event_listener, event: resource.load, method: load }
            - { name: kernel.event_listener, event: resource.embed, method: embed }
            - { name: kernel.event_listener, event: resource.create, method: create }
            - { name: kernel.event_listener, event: resource.configure, method: configure }
            - { name: kernel.event_listener, event: resource.rights, method: rights }
            - { name: kernel.event_listener, event: resource.publish, method: publish }
            - { name: kernel.event_listener, event: resource.unpublish, method: unpublish }
            - { name: kernel.event_listener, event: resource.export, method: export }
            - { name: kernel.event_listener, event: resource.delete, method: delete }
            - { name: kernel.event_listener, event: resource.restore, method: restore }
            - { name: kernel.event_listener, event: resource.copy, method: copy }
            - { name: kernel.event_listener, event: resource.move, method: move }

    Claroline\CoreBundle\Listener\ViewAsListener:
        arguments:
            - '@security.authorization_checker'
            - '@security.token_storage'
            - '@event_dispatcher'
            - '@Claroline\AuthenticationBundle\Security\Authentication\Authenticator'
            - '@Claroline\CoreBundle\Manager\RoleManager'
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onViewAs, priority: 2 }

    Claroline\CoreBundle\Listener\PlatformListener:
        arguments:
            - '@security.token_storage'
            - '@translator'
            - '@Claroline\CoreBundle\Library\Configuration\PlatformConfigurationHandler'
            - '@Claroline\CoreBundle\Manager\VersionManager'
            - '@Claroline\AppBundle\Manager\File\TempFileManager'
            - '@Claroline\CoreBundle\Manager\LocaleManager'
            - '@Claroline\CoreBundle\Library\RoutingHelper'
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: setLocale, priority: 17 }
            - { name: kernel.event_listener, event: kernel.request, method: checkAvailability }
            - { name: kernel.event_listener, event: kernel.terminate, method: clearTemp }
            - { name: kernel.event_listener, event: platform.connection_messages.populate, method: displayVersionChangeLogs }

    Claroline\CoreBundle\Listener\CommandListener:
        arguments:
            - '@translator'
            - '@Claroline\CoreBundle\Library\Configuration\PlatformConfigurationHandler'
            - '@Claroline\AuthenticationBundle\Security\Authentication\Authenticator'
            - '@Claroline\CoreBundle\Manager\UserManager'
        tags:
            - { name: kernel.event_listener, event: console.command, method: setDefaultUser, priority: 17 }
            - { name: kernel.event_listener, event: console.command, method: setLocale, priority: 16 }

    Claroline\CoreBundle\Listener\AuthenticationSuccessListener:
        arguments:
            - '@event_dispatcher'
            - '@Claroline\AppBundle\API\SerializerProvider'
            - '@Claroline\CoreBundle\Library\RoutingHelper'
            - '@Claroline\AppBundle\Manager\PlatformManager'
            - '@Claroline\AppBundle\Component\Context\ContextProvider'
            - '@Claroline\CoreBundle\Manager\UserManager'
            - '@Claroline\CoreBundle\Manager\ConnectionMessageManager'
            - '@Claroline\AppBundle\Manager\ClientManager'
