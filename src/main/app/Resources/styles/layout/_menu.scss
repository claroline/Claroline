
@use "sass:math";

.app-menu {
    overflow-y: auto; // gets its own scrollbar

    width: 100%;
    top: 0;
    bottom: 0;
    display: flex;
    flex-direction: column;
    background-color: $toolbar-bg;
    color: $toolbar-color;

    max-width: 0;
    transition: max-width .6s ease;

    &.show {
        max-width: $toolbar-size;
    }

    .dropdown-menu {
        width: $toolbar-size;
    }
}

.app-menu-backdrop {
    opacity: 0;
    transition: opacity .3s ease;
}

.app-menu-cover {
    height: 6.5rem;
    text-align: center;
    padding-bottom: 2.5rem;
    flex-shrink: 0;
    background: $toolbar-link-hover-bg;
}

.app-menu-current-user {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: map-get($spacers, 3);
    padding-top: 0;
    min-height: 6.5rem;

    .user-avatar {
        margin-top: -2.5rem;
        background: $toolbar-bg;
        padding: $thumbnail-padding;
        //border-radius: 50%;
    }

    .user-status-bullet {
        border-color: $toolbar-bg !important;
    }

    .app-menu-user {
        color: $toolbar-color;
        small {
            color: $toolbar-link-color;
        }
    }
}

.app-menu-header {
    .app-menu-title {
        margin: 0;
        padding: 0;
        font-weight: $font-weight-medium;
        font-size: $font-size-base;
    }

    .btn {
        color: $toolbar-link-color;
        box-shadow: none !important;
        border-color: transparent !important;

        &:hover {
            color: $toolbar-link-hover-color;
            //background: $toolbar-link-hover-bg;
        }

        &:focus,
        &:active,
        &.active {
            &,
            &:hover,
            &:focus {
                color: $toolbar-link-active-color;
                //background-color: $toolbar-link-active-bg;
            }
        }
    }
}

.app-menu-impersonation {
    @include gradient-striped($toolbar-bg, 45deg);

    background-size: 100px 100px;
}

.app-menu-items {
    display: flex;
    flex-direction: column;
    justify-content: stretch;
    gap: $toolbar-link-spacer-y;
}

.app-menu-item {
    padding: $toolbar-link-padding-y $toolbar-link-padding-x;
    margin: 0 $toolbar-link-spacer-x;
    color: $toolbar-link-color;
    background: $toolbar-link-bg;
    border: none;
    box-shadow: none;
    text-align: left;
    white-space: nowrap;

    @include border-radius($toolbar-link-border-radius);

    &:hover {
        color: $toolbar-link-hover-color;
        background: $toolbar-link-hover-bg;
        text-decoration: none;
    }

    &:focus,
    &:active,
    &.active {
        &,
        &:hover,
        &:focus {
            color: $toolbar-link-active-color;
            background-color: $toolbar-link-active-bg;
            box-shadow: none;
        }
    }

    &[disabled],
    &.disabled {
        // avoid focus or hover effect on disabled
        &,
        &:hover,
        &:focus {
            color: $toolbar-link-disabled-color;
            background-color: $toolbar-link-disabled-bg;
        }

        // preserve active state on disabled (because active links are disabled)
        &.active {
            &,
            &:hover,
            &:focus {
                color: $toolbar-link-active-color;
                background: $toolbar-link-active-bg;
                opacity: 1;
            }
        }
    }
}

// XS/SM screens :
@media (max-width: map-get($grid-breakpoints, 'xl')) {
    .app-contexts + .app-menu,
    .app-contexts + .app-menu + .app-menu-backdrop {
        left: 72px !important; // FIXME
    }

    .app-menu {
        position: absolute;
        z-index: $zindex-fixed;

        &.show {
            //@include box-shadow(0 0 3px 1px rgba(0, 0, 0, 0.5));
            + .app-menu-backdrop {
                position: fixed;
                z-index: $zindex-fixed - 1;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);

                opacity: 1;
            }
        }
    }
}
